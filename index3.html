<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœå‹™åŸ·è¡Œæ­·ç¨‹æŸ¥è©¢åŠ©æ‰‹</title>
    <style>
        /* åŸºç¤é‡ç½®ï¼Œå›æ­¸æœ€ä¹¾æ·¨çš„ç³»çµ±ä»‹é¢ */
        body {
            font-family: Arial, "Microsoft JhengHei", sans-serif;
            margin: 20px;
            background-color: #fff;
            color: #333;
            font-size: 14px;
        }

        /* æ¨™é¡Œå€ï¼šå–®ç´”æ–‡å­— */
        .page-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            border-bottom: 2px solid #0056b3;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .version-text {
            font-size: 12px;
            color: #666;
            margin-left: 10px;
            font-weight: normal;
            background: #eee;
            padding: 2px 5px;
            border-radius: 3px;
        }

        /* æœå°‹å€å¡Šï¼šæ©«å‘æ’åˆ—ï¼Œå‚³çµ±ç³»çµ±é¢¨æ ¼ */
        .search-container {
            background-color: #f5f5f5;
            padding: 15px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .search-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        label {
            font-weight: bold;
        }

        input[type="month"], 
        input[type="text"], 
        select {
            padding: 5px;
            border: 1px solid #ccc;
            height: 30px;
            box-sizing: border-box;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn-search {
            background-color: #0056b3;
            color: white;
            border: none;
            padding: 5px 20px;
            height: 30px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-search:hover { background-color: #004494; }

        /* è¡¨æ ¼æ¨£å¼ï¼šæ¨™æº–ç·šæ¡†è¡¨æ ¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ccc;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 8px 10px;
            text-align: left;
        }

        th {
            background-color: #e9ecef;
            font-weight: bold;
            color: #333;
        }

        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f1f1f1; }

        /* æŒ‰éˆ•èˆ‡ç‹€æ…‹ */
        .status-ok { color: green; font-weight: bold; }
        .status-wait { color: #d9534f; font-weight: bold; }

        .btn-view {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 3px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        .btn-view:hover { background-color: #5a6268; }

        /* åˆå§‹æç¤º */
        .init-msg {
            text-align: center;
            padding: 40px;
            color: #777;
            border: 1px dashed #ccc;
            background: #fafafa;
        }

        /* --- è·³çª— (Modal) æ¨£å¼ --- */
        .modal-mask {
            display: none; 
            position: fixed; 
            z-index: 9999; 
            left: 0; top: 0; 
            width: 100%; height: 100%; 
            background-color: rgba(0,0,0,0.6); 
        }

        .modal-box {
            background-color: #fff;
            margin: 5% auto; 
            padding: 0; 
            border: 1px solid #888; 
            width: 70%; 
            height: 85%;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .modal-header {
            padding: 10px 15px;
            background: #0056b3;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            position: relative;
            background: #eee;
            user-select: none; /* ç¦æ­¢é¸å– */
        }

        .doc-page {
            background: white;
            width: 210mm; /* A4 width */
            min-height: 297mm;
            margin: 0 auto;
            padding: 20px;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
            position: relative;
        }

        .close {
            color: white;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover { color: #ccc; }

        /* æµ®æ°´å° */
        .watermark {
            position: absolute;
            top: 40%; left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 50px;
            color: rgba(255,0,0,0.1);
            pointer-events: none;
            white-space: nowrap;
            border: 5px solid rgba(255,0,0,0.1);
            padding: 20px;
        }

    </style>
</head>
<body>

    <div class="page-title">
        <span>ğŸ¤– æœå‹™åŸ·è¡Œæ­·ç¨‹æŸ¥è©¢åŠ©æ‰‹</span>
        <span class="version-text">V1.01</span>
    </div>

    <div class="search-container">
        <div class="search-item">
            <label>å¹´ä»½/æœˆä»½ï¼š</label>
            <input type="month" id="s-date" value="2026-06">
        </div>
        <div class="search-item">
            <label>å…¬å¸åç¨±/çµ±ç·¨ï¼š</label>
            <input type="text" id="s-keyword" placeholder="è¼¸å…¥é—œéµå­—..." style="width: 200px;">
        </div>
        <div class="search-item">
            <label>ç´€éŒ„é¡å‹ï¼š</label>
            <select id="s-type">
                <option value="">å…¨éƒ¨</option>
                <option value="site">è‡¨å ´æœå‹™</option>
                <option value="doc">æ–‡ä»¶å¯©æŸ¥</option>
                <option value="meet">æœƒè­°ç´€éŒ„</option>
            </select>
        </div>
        <button class="btn-search" onclick="doSearch()">æœå°‹</button>
    </div>

    <div id="result-container">
        <div class="init-msg" id="init-msg">
            è«‹è¼¸å…¥æ¢ä»¶ä¸¦é»æ“Šã€Œæœå°‹ã€æŒ‰éˆ•ä»¥æŸ¥è©¢è³‡æ–™ã€‚
        </div>

        <table id="result-table" style="display: none;">
            <thead>
                <tr>
                    <th width="120">è¨ªè¦–æ—¥æœŸ â–¼</th> <th>ä¼æ¥­åç¨±</th>
                    <th width="100">ç´€éŒ„é¡å‹</th>
                    <th width="100">åŸ·è¡Œäººå“¡</th>
                    <th width="80">ç‹€æ…‹</th>
                    <th width="120">åŠŸèƒ½</th>
                </tr>
            </thead>
            <tbody id="result-body">
                </tbody>
        </table>
    </div>

    <div id="previewModal" class="modal-mask" onclick="closeModal(event)">
        <div class="modal-box" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span id="modal-title">æ–‡ä»¶é è¦½</span>
                <span class="close" onclick="closeModalDirect()">&times;</span>
            </div>
            <div class="modal-body" oncontextmenu="return false;">
                <div class="doc-page">
                    <div class="watermark">åƒ…ä¾›é è¦½ ç¦æ­¢ä¸‹è¼‰</div>
                    <h2 style="text-align:center; text-decoration: underline;">æœå‹™åŸ·è¡Œç´€éŒ„è¡¨</h2>
                    <br>
                    <p><b>è¨ªè¦–æ—¥æœŸï¼š</b> <span id="v-date"></span></p>
                    <p><b>å®¢æˆ¶åç¨±ï¼š</b> <span id="v-name"></span></p>
                    <p><b>åŸ·è¡Œäººå“¡ï¼š</b> <span id="v-staff"></span></p>
                    <hr>
                    <p><b>ã€æœå‹™å…§å®¹æ‘˜è¦ã€‘</b></p>
                    <p>1. è·æ¥­å®‰å…¨è¡›ç”Ÿæ•™è‚²è¨“ç·´ (3å°æ™‚)ã€‚</p>
                    <p>2. ä½œæ¥­ç’°å¢ƒç›£æ¸¬çµæœè©•ä¼°èˆ‡å»ºè­°ã€‚</p>
                    <p>3. å“¡å·¥å¥åº·æª¢æŸ¥åˆ†ç´šç®¡ç† (Grade 2)ã€‚</p>
                    <br><br>
                    <div style="border: 1px solid #ccc; height: 300px; display: flex; align-items: center; justify-content: center; color: #999; background: #f9f9f9;">
                        [ æ–‡ä»¶å½±åƒæƒææª” é è¦½å€åŸŸ ]
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬è³‡æ–™ (äº‚åºï¼Œæ¸¬è©¦æ’åºç”¨)
        const dbData = [
            { date: "2025-08-31", name: "å°ç£éµé«˜è³‡è¨Š", type: "è‡¨å ´æœå‹™", staff: "å°¤å¿—å‰", status: 1 },
            { date: "2026-06-14", name: "å°ç£éµé«˜è³‡è¨Š", type: "è‡¨å ´æœå‹™", staff: "é»ƒæ…§ç²", status: 1 },
            { date: "2024-12-10", name: "æ„›å‘³ä¹‹è³‡è¨Š", type: "æ–‡ä»¶å¯©æŸ¥", staff: "æ—ä¸–æ˜", status: 1 },
            { date: "2026-01-25", name: "å°ç£éµé«˜è³‡è¨Š", type: "è‡¨å ´æœå‹™", staff: "é„­é›…è", status: 1 },
            { date: "2026-03-02", name: "è¦‹é é›œèªŒè³‡è¨Š", type: "æœƒè­°ç´€éŒ„", staff: "æ¥Šæ©ç¢©", status: 0 }
        ];

        function doSearch() {
            // 1. éš±è—æç¤ºï¼Œé¡¯ç¤ºè¡¨æ ¼
            document.getElementById('init-msg').style.display = 'none';
            document.getElementById('result-table').style.display = 'table';
            
            const keyword = document.getElementById('s-keyword').value;
            const tbody = document.getElementById('result-body');
            tbody.innerHTML = "";

            // 2. ç¯©é¸è³‡æ–™
            let list = dbData;
            if (keyword) {
                list = list.filter(d => d.name.includes(keyword));
            }

            // 3. æ’åºï¼šæ—¥æœŸé™å†ª (æœ€æ–°åœ¨ä¸Šé¢)
            list.sort((a, b) => new Date(b.date) - new Date(a.date));

            // 4. ç”¢ç”Ÿåˆ—è¡¨
            if (list.length === 0) {
                tbody.innerHTML = "<tr><td colspan='6' style='text-align:center; padding:20px;'>æŸ¥ç„¡è³‡æ–™</td></tr>";
                return;
            }

            list.forEach(item => {
                const statusHtml = item.status === 1 
                    ? '<span class="status-ok">å®Œæˆ</span>' 
                    : '<span class="status-wait">é€²è¡Œä¸­</span>';

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.name}</td>
                    <td>${item.type}</td>
                    <td>${item.staff}</td>
                    <td>${statusHtml}</td>
                    <td>
                        <button class="btn-view" onclick="openModal('${item.name}', '${item.date}', '${item.staff}')">
                            ğŸ‘ï¸ é»é¸è·³çª—é è¦½
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // --- è·³çª—æ§åˆ¶ ---
        function openModal(name, date, staff) {
            document.getElementById('modal-title').innerText = "é è¦½ï¼š" + name;
            document.getElementById('v-name').innerText = name;
            document.getElementById('v-date').innerText = date;
            document.getElementById('v-staff').innerText = staff;
            document.getElementById('previewModal').style.display = "block";
        }

        function closeModal(e) {
            if (e.target.className === "modal-mask") {
                document.getElementById('previewModal').style.display = "none";
            }
        }
        function closeModalDirect() {
            document.getElementById('previewModal').style.display = "none";
        }
    </script>
</body>
</html>
