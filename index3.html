<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœå‹™åŸ·è¡Œæ­·ç¨‹æŸ¥è©¢åŠ©æ‰‹ V1.01</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --bg-color: #f8f9fa;
            --text-color: #333;
        }

        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        /* æ¨™é¡Œå€å¡Š */
        header {
            margin-bottom: 30px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        h1 {
            color: var(--primary-color);
            display: flex;
            align-items: baseline;
            gap: 10px;
            margin: 0;
        }

        .version-tag {
            font-size: 0.5em;
            color: gray;
            font-weight: normal;
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* æœå°‹å€å¡Š */
        .search-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-size: 0.9em;
            margin-bottom: 5px;
            color: #666;
        }

        input, select {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1em;
            min-width: 150px;
        }

        button#search-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            margin-top: auto; /* å°é½Šåº•éƒ¨ */
            transition: background 0.2s;
        }

        button#search-btn:hover {
            background-color: #2980b9;
        }

        /* çµæœé¡¯ç¤ºå€å¡Š */
        #result-area {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            min-height: 200px;
        }

        /* åˆå§‹ç‹€æ…‹æç¤º */
        .empty-state {
            text-align: center;
            color: #888;
            padding: 50px 0;
        }
        .empty-state i {
            font-size: 3em;
            margin-bottom: 15px;
            display: block;
            opacity: 0.5;
        }

        /* è¡¨æ ¼æ¨£å¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f1f3f5;
            color: var(--primary-color);
            font-weight: bold;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.85em;
        }
        .status-done { background-color: #d4edda; color: #155724; }
        .status-pending { background-color: #fff3cd; color: #856404; }

        .btn-preview {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        .btn-preview:hover {
            background-color: #5a6268;
        }

        /* è·³çª— (Modal) æ¨£å¼ */
        .modal-overlay {
            display: none; /* é è¨­éš±è— */
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            width: 80%;
            max-width: 800px;
            height: 80vh;
            border-radius: 8px;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f1f3f5;
            border-radius: 8px 8px 0 0;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #666;
        }

        .modal-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            
            /* ç¦æ­¢é¸å–æ–‡å­— (é˜²è¤‡è£½) */
            user-select: none;
            -webkit-user-select: none;
        }

        /* æ¨¡æ“¬æ–‡ä»¶é è¦½å€ */
        .document-viewer {
            background: white;
            width: 100%;
            max-width: 700px;
            min-height: 800px;
            padding: 40px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            position: relative;
        }

        /* æµ®æ°´å° */
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 3em;
            color: rgba(255, 0, 0, 0.15);
            font-weight: bold;
            pointer-events: none; /* è®“é»æ“Šç©¿é€ */
            white-space: nowrap;
            z-index: 10;
        }

        /* éš±è—ä¸‹è¼‰ç›¸é—œæç¤º (æ¨¡æ“¬) */
        @media print {
            body { display: none; }
        }

    </style>
</head>
<body>

    <header>
        <h1>
            ğŸ¤– æœå‹™åŸ·è¡Œæ­·ç¨‹æŸ¥è©¢åŠ©æ‰‹ 
            <span class="version-tag">V1.01</span>
        </h1>
    </header>

    <div class="search-panel">
        <div class="form-group">
            <label>ğŸ“… å¹´ä»½/æœˆä»½</label>
            <input type="month" id="search-date" value="2026-06">
        </div>
        <div class="form-group">
            <label>ğŸ¢ å…¬å¸åç¨± / çµ±ç·¨</label>
            <input type="text" id="search-company" placeholder="ä¾‹å¦‚ï¼šå°ç£éµé«˜">
        </div>
        <div class="form-group">
            <label>ğŸ“‹ ç´€éŒ„é¡å‹</label>
            <select id="search-type">
                <option value="all">å…¨éƒ¨é¡å‹</option>
                <option value="site">è‡¨å ´æœå‹™</option>
                <option value="doc">æ–‡ä»¶å¯©æŸ¥</option>
                <option value="meet">æœƒè­°ç´€éŒ„</option>
            </select>
        </div>
        <button id="search-btn" onclick="performSearch()">ğŸ” æœå°‹</button>
    </div>

    <div id="result-area">
        <div id="initial-message" class="empty-state">
            <i>â„¹ï¸</i>
            <h3>ç­‰å¾…è¼¸å…¥...</h3>
            <p>è«‹è¼¸å…¥ç¯©é¸æ¢ä»¶ä¸¦é»æ“Šã€Œæœå°‹ã€æŒ‰éˆ•ï¼Œ<br>AI åŠ©æ‰‹å°‡ç‚ºæ‚¨èª¿é–±ç›¸é—œå±¥æ­·ã€‚</p>
        </div>

        <div id="result-table-container" style="display: none;">
            <table id="data-table">
                <thead>
                    <tr>
                        <th>è¨ªè¦–æ—¥æœŸ â–¼</th>
                        <th>ä¼æ¥­åç¨±</th>
                        <th>ç´€éŒ„é¡å‹</th>
                        <th>åŸ·è¡Œäººå“¡</th>
                        <th>ç‹€æ…‹</th>
                        <th>æ“ä½œåŠŸèƒ½</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    </tbody>
            </table>
        </div>
    </div>

    <div id="preview-modal" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()"> <div class="modal-header">
                <h3 style="margin:0">ğŸ“„ æ–‡ä»¶é è¦½æ¨¡å¼</h3>
                <button class="close-btn" onclick="closeModalDirect()">Ã—</button>
            </div>
            
            <div class="modal-body" oncontextmenu="return false;">
                <div class="document-viewer">
                    <div class="watermark">åƒ…ä¾›ç·šä¸Šå¯©æŸ¥ - åš´ç¦ä¸‹è¼‰</div>
                    
                    <h2 style="text-align:center; border-bottom:2px solid #333; padding-bottom:10px;">è‡¨å ´æœå‹™åŸ·è¡Œç´€éŒ„è¡¨</h2>
                    <p><strong>ä¼æ¥­åç¨±ï¼š</strong> <span id="modal-company"></span></p>
                    <p><strong>è¨ªè¦–æ—¥æœŸï¼š</strong> <span id="modal-date"></span></p>
                    <p><strong>åŸ·è¡Œäººå“¡ï¼š</strong> <span id="modal-staff"></span></p>
                    <hr>
                    <h4>è¨ªè¦–å…§å®¹æ‘˜è¦ï¼š</h4>
                    <p>1. æª¢è¦–ä½œæ¥­ç’°å¢ƒç›£æ¸¬å ±å‘Šï¼Œå™ªéŸ³å€åŸŸå·²æ¨™ç¤ºã€‚</p>
                    <p>2. å“¡å·¥å¥åº·æª¢æŸ¥åˆ†ç´šç®¡ç†ï¼ˆäºŒç´šç®¡ç†äººå“¡è¡›æ•™ï¼‰ã€‚</p>
                    <p>3. å‘¼å¸é˜²è­·å…·ä½©æˆ´æŒ‡å°ã€‚</p>
                    <br><br><br>
                    <p style="text-align:right;">(æ­¤è™•ç‚ºæ–‡ä»¶æƒææª”é è¦½å€)</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬å¾Œç«¯è³‡æ–™åº« (åŒ…å«ä¸åŒæ—¥æœŸçš„è³‡æ–™ä»¥æ¸¬è©¦æ’åº)
        const mockDatabase = [
            { date: "2025-08-31", company: "å°ç£éµé«˜è³‡è¨Š", type: "è‡¨å ´æœå‹™", staff: "å°¤å¿—å‰", status: "finished" },
            { date: "2026-01-25", company: "å°ç£éµé«˜è³‡è¨Š", type: "è‡¨å ´æœå‹™", staff: "é„­é›…è", status: "finished" },
            { date: "2024-12-10", company: "æ„›å‘³ä¹‹è³‡è¨Š", type: "æ–‡ä»¶å¯©æŸ¥", staff: "æ—ä¸–æ˜", status: "finished" },
            { date: "2026-06-14", company: "å°ç£éµé«˜è³‡è¨Š", type: "è‡¨å ´æœå‹™", staff: "é»ƒæ…§ç²", status: "finished" },
            { date: "2026-03-02", company: "è¦‹é é›œèªŒè³‡è¨Š", type: "æœƒè­°ç´€éŒ„", staff: "æ¥Šæ©ç¢©", status: "pending" }
        ];

        // åŸ·è¡Œæœå°‹åŠŸèƒ½
        function performSearch() {
            // 1. å–å¾—ä½¿ç”¨è€…è¼¸å…¥ (æ­¤è™•åƒ…åšç°¡å–®æ¨¡æ“¬ï¼Œå¯¦éš›æœƒå‚³é€çµ¦å¾Œç«¯ API)
            const keyword = document.getElementById('search-company').value;
            
            // 2. åˆ‡æ› UI ç‹€æ…‹ï¼šéš±è—åˆå§‹è¨Šæ¯ï¼Œé¡¯ç¤ºè¡¨æ ¼
            document.getElementById('initial-message').style.display = 'none';
            document.getElementById('result-table-container').style.display = 'block';

            // 3. ç¯©é¸è³‡æ–™ (ç°¡å–®æ¨¡æ“¬ï¼šè‹¥æ²’è¼¸å…¥å°±é¡¯ç¤ºå…¨éƒ¨)
            let results = mockDatabase;
            if (keyword) {
                results = results.filter(item => item.company.includes(keyword));
            }

            // 4. â˜… é‡è¦ï¼šæ’åºé‚è¼¯ (æŒ‡ä»¤ 5)
            // ä½¿ç”¨ sort é€²è¡Œé™å†ªæ’åº (æœ€æ–°çš„æ—¥æœŸåœ¨å‰é¢)
            // Date b - Date a
            results.sort((a, b) => new Date(b.date) - new Date(a.date));

            // 5. æ¸²æŸ“è¡¨æ ¼
            renderTable(results);
        }

        function renderTable(data) {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = ''; // æ¸…ç©ºèˆŠè³‡æ–™

            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;">æŸ¥ç„¡è³‡æ–™</td></tr>';
                return;
            }

            data.forEach(item => {
                const tr = document.createElement('tr');
                
                // ç‹€æ…‹é¡¯ç¤ºè™•ç†
                const statusHtml = item.status === 'finished' 
                    ? '<span class="status-badge status-done">âœ… å®Œæˆ</span>'
                    : '<span class="status-badge status-pending">ğŸ•’ å¾…è™•ç†</span>';

                tr.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.company}</td>
                    <td>${item.type}</td>
                    <td>${item.staff}</td>
                    <td>${statusHtml}</td>
                    <td>
                        <button class="btn-preview" onclick="openPreview('${item.company}', '${item.date}', '${item.staff}')">
                            ğŸ‘ï¸ é»é¸è·³çª—é è¦½
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // --- è·³çª—é è¦½ç›¸é—œåŠŸèƒ½ (æŒ‡ä»¤ 4) ---

        function openPreview(company, date, staff) {
            // å¡«å…¥è³‡æ–™åˆ° Modal
            document.getElementById('modal-company').innerText = company;
            document.getElementById('modal-date').innerText = date;
            document.getElementById('modal-staff').innerText = staff;

            // é¡¯ç¤º Modal
            document.getElementById('preview-modal').style.display = 'flex';
        }

        function closeModal(event) {
            // é»æ“ŠèƒŒæ™¯æ‰é—œé–‰
            if (event.target.id === 'preview-modal') {
                document.getElementById('preview-modal').style.display = 'none';
            }
        }

        function closeModalDirect() {
            document.getElementById('preview-modal').style.display = 'none';
        }

        // éµç›¤ ESC é—œé–‰æ”¯æ´
        document.addEventListener('keydown', function(event) {
            if (event.key === "Escape") {
                closeModalDirect();
            }
        });
    </script>
</body>
</html>
